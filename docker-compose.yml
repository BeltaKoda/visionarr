# Visionarr Development Docker Compose
# Use for local testing before deploying to Unraid

services:
  visionarr:
    build: .
    container_name: visionarr
    environment:
      # Required: At least one of Radarr/Sonarr
      - RADARR_URL=${RADARR_URL:-}
      - RADARR_API_KEY=${RADARR_API_KEY:-}
      - SONARR_URL=${SONARR_URL:-}
      - SONARR_API_KEY=${SONARR_API_KEY:-}
      
      # Operation mode
      - DRY_RUN=${DRY_RUN:-true}
      - MANUAL_MODE=${MANUAL_MODE:-false}
      
      # Polling
      - POLL_INTERVAL_SECONDS=${POLL_INTERVAL_SECONDS:-300}
      - LOOKBACK_MINUTES=${LOOKBACK_MINUTES:-60}
      
      # Processing
      - PROCESS_CONCURRENCY=${PROCESS_CONCURRENCY:-1}
      - MIN_FREE_SPACE_GB=${MIN_FREE_SPACE_GB:-50}
      
      # Backup
      - BACKUP_ENABLED=${BACKUP_ENABLED:-true}
      - BACKUP_RETENTION_DAYS=${BACKUP_RETENTION_DAYS:-7}
      
      # Logging
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      
      # Notifications (optional)
      - WEBHOOK_URL=${WEBHOOK_URL:-}
    
    volumes:
      # CRITICAL: These MUST be real paths, not container-internal
      # On Unraid, use /mnt/user/... paths
      - ./data/config:/config
      - ./data/temp:/temp
      - /path/to/your/media:/media
    
    # For manual mode, use interactive terminal
    # docker compose run --rm visionarr --manual
    stdin_open: true
    tty: true
    
    restart: unless-stopped
