<?xml version="1.0"?>
<Container version="2">
  <Name>visionarr</Name>
  <Repository>ghcr.io/beltakoda/visionarr:latest</Repository>
  <Registry>https://ghcr.io</Registry>
  <Network>br0.6</Network>
  <Privileged>false</Privileged>
  <Support>https://github.com/BeltaKoda/visionarr/issues</Support>
  <Project>https://github.com/BeltaKoda/visionarr</Project>
  <Overview>
    Visionarr monitors Radarr/Sonarr for new imports and automatically converts 
    Dolby Vision Profile 7 content to Profile 8 for better device compatibility 
    (Nvidia Shield, Apple TV, Infuse, etc.).
    
    Profile 7 (Blu-ray dual-layer) can trigger transcoding in Plex/Jellyfin.
    Profile 8 (streaming single-layer) works everywhere.
    
    No transcoding - just metadata conversion. No quality loss!
    
    IMPORTANT: Start with DRY_RUN=true to verify detection before enabling conversions.
  </Overview>
  <Category>MediaApp:Video</Category>
  <Icon>https://raw.githubusercontent.com/BeltaKoda/visionarr/main/assets/icon.png</Icon>
  <TemplateURL>https://raw.githubusercontent.com/BeltaKoda/visionarr/main/unraid/visionarr.xml</TemplateURL>
  <Maintainer>BeltaKoda</Maintainer>
  <Shell>bash</Shell>
  <ExtraParams>--init --restart=unless-stopped</ExtraParams>
  
  <!-- Environment Variables -->
  <Config Name="Radarr URL" Target="RADARR_URL" Default="http://172.16.6.6:7878" Mode="" Description="Radarr base URL" Type="Variable" Display="always" Required="true" Mask="false"/>
  <Config Name="Radarr API Key" Target="RADARR_API_KEY" Default="bf21975482774bbda65f7285d9fe32fc" Mode="" Description="Radarr API key" Type="Variable" Display="always" Required="true" Mask="true"/>
  <Config Name="Sonarr URL" Target="SONARR_URL" Default="http://172.16.6.4:8989" Mode="" Description="Sonarr base URL" Type="Variable" Display="always" Required="false" Mask="false"/>
  <Config Name="Sonarr API Key" Target="SONARR_API_KEY" Default="cbcbffdc8d2c4a5aa9df50f61b3e16f6" Mode="" Description="Sonarr API key" Type="Variable" Display="always" Required="false" Mask="true"/>
  
  <Config Name="Dry Run" Target="DRY_RUN" Default="true" Mode="" Description="When true, logs what would happen without modifying files. START WITH THIS TRUE!" Type="Variable" Display="always" Required="false" Mask="false"/>
  
  <Config Name="Poll Interval (seconds)" Target="POLL_INTERVAL_SECONDS" Default="300" Mode="" Description="How often to check for new imports (default: 5 minutes)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Lookback (minutes)" Target="LOOKBACK_MINUTES" Default="60" Mode="" Description="How far back to look in history for new imports" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Process Concurrency" Target="PROCESS_CONCURRENCY" Default="1" Mode="" Description="Max simultaneous conversions (recommend: 1)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Min Free Space (GB)" Target="MIN_FREE_SPACE_GB" Default="50" Mode="" Description="Minimum disk space required before processing" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  
  <Config Name="Backup Enabled" Target="BACKUP_ENABLED" Default="true" Mode="" Description="Keep .original backup files after conversion" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Backup Retention (days)" Target="BACKUP_RETENTION_DAYS" Default="7" Mode="" Description="Auto-delete backups after X days (0 = never)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  
  <Config Name="Log Level" Target="LOG_LEVEL" Default="INFO" Mode="" Description="Logging verbosity: DEBUG, INFO, WARNING, ERROR" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Webhook URL" Target="WEBHOOK_URL" Default="" Mode="" Description="Discord/Slack webhook for notifications (optional)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  
  <!-- Volume Mappings - MUST match Radarr/Sonarr mount points -->
  <Config Name="Config" Target="/config" Default="/mnt/user/appdata/visionarr" Mode="rw" Description="Persistent config and database storage" Type="Path" Display="always" Required="true" Mask="false"/>
  <Config Name="Temp" Target="/temp" Default="/mnt/user/appdata/visionarr/temp" Mode="rw" Description="CRITICAL: Temp files during conversion. Use cache drive if available!" Type="Path" Display="always" Required="true" Mask="false"/>
  <Config Name="Movies" Target="/movies" Default="/mnt/user/movies" Mode="rw" Description="Movies folder - MUST match Radarr's /movies mount" Type="Path" Display="always" Required="true" Mask="false"/>
  <Config Name="TV Shows" Target="/tv" Default="/mnt/user/shows" Mode="rw" Description="TV Shows folder - MUST match Sonarr's /tv mount" Type="Path" Display="always" Required="true" Mask="false"/>
</Container>
